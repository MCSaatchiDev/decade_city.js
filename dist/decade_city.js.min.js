/*! decade_city.js - v0.2.0 - 2013-03-04
* https://github.com/decadecity/decade_city.js
* Copyright (c) 2013 Orde Saunders; Licensed MIT */
window.DECADE_CITY=function(e,t){var n=[],r=!1;return e.register=function(e){typeof e=="function"&&(r?e.call():n.push(e))},e.init=function(){t.each(n,function(e,t){t.call()}),r=!0},e}(window.DECADE_CITY||{},window.jQuery),window.DECADE_CITY=function(e){"use strict";return e.COOKIES=function(e,t){var n=window.escape,r=window.unescape;return t.getItem=function(e){return!e||!this.hasItem(e)?null:r(document.cookie.replace(new RegExp("(?:^|.*;\\s*)"+n(e).replace(/[\-\.\+\*]/g,"\\$&")+"\\s*\\=\\s*((?:[^;](?!;))*[^;]?).*"),"$1"))},t.setItem=function(e,t,r,i,s,o){if(!e||/^(?:expires|max\-age|path|domain|secure)$/.test(e))return;var u="";if(r)switch(typeof r){case"number":u="; max-age="+r;break;case"string":u="; expires="+r;break;case"object":r.hasOwnProperty("toGMTString")&&(u=";expires="+r.toGMTString())}document.cookie=n(e)+"="+n(t)+u+(s?";domain="+s:"")+(i?";path="+i:"")+(o?";secure":"")},t.removeItem=function(e){if(!e||!this.hasItem(e))return;document.cookie=n(e)+"=;expires=Thu, 01-Jan-1970 00:00:01 GMT;"},t.hasItem=function(e){return(new RegExp("(?:^|;\\s*)"+n(e).replace(/[\-\.\+\*]/g,"\\$&")+"\\s*\\=")).test(document.cookie)},t}(e,e.COOKIES||{}),e}(window.DECADE_CITY||{}),window.DECADE_CITY=function(e,t){"use strict";return e.PROFILE=function(e,t,n){var r=new Image,i=n("html"),s,o;s=function(){t.profile.json&&typeof e.COOKIES!="undefined"&&e.COOKIES.setItem("profile",JSON.stringify(t.profile),null,"/")},t.profile=t.profile||{},t.profile.profile=!0,t.profile.svg=!1,!document.implementation.hasFeature("http://www.w3.org/TR/SVG11/feature#BasicStructure","1.1")||(t.profile.svg=!0),e.transform_prefix="","webkitTransform"in r.style?(e.transform_prefix="-webkit-",t.profile.transform=!0):"MozTransform"in r.style?(e.transform_prefix="-moz-",t.profile.transform=!0):"OTransform"in r.style?(e.transform_prefix="-o-",t.profile.transform=!0):"transform"in r.style&&(e.transform_prefix="",t.profile.transform=!0),t.profile.transform&&i.addClass("transform");if("ontouchstart"in window||typeof navigator.msMaxTouchPoints!="undefined"&&navigator.msMaxTouchPoints>0)t.profile.touch=!0,n(i).hasClass("pointer")&&n(i).removeClass("pointer");return typeof JSON!="undefined"&&(t.profile.json=!0),o=document.createElement("script"),o.setAttribute("async",!0),t.profile.async_scripts=!!o.async,t.sendProfile=function(r){if(typeof e.COOKIES=="undefined")return!1;n(document).ready(function(){window.setTimeout(function(){s();if(!e.COOKIES.getItem("profile_sent")||r)n.get("/profile",t.profile),e.COOKIES.setItem("profile_sent",1,null,"/")},100)})},e.register(t.sendProfile),e.register(s),t}(e,e.PROFILE||{},t),e}(window.DECADE_CITY||{},window.jQuery),window.DECADE_CITY=function(e,t){"use strict";return e.IMAGES=function(e,t,n){t._svgSrc=function(e){return e.replace(/\.[^.\?]*($|\?)/,".svg$1")};var r=function(){e.PROFILE.svg&&n(".svg-replace").each(function(){n(this).attr("src",function(e,n){return t._svgSrc(n)}),n(this).removeClass("svg-replace")})};return e.register(r),t}(e,e.IMAGES||{},t),e}(window.DECADE_CITY||{},window.jQuery),window.DECADE_CITY=function(e,t){"use strict";return e.FLICKR=function(e,t,n){var r=/^http(s)?:\/\/(.*)\.staticflickr.com\/(.*?)(_.\.jpg|\.jpg)$/,i,s;return i=function(e){return e=parseInt(e,10),isNaN(e)&&(e=0),e},t._flickr_suffix="_m",t._flickr_suffix_set=!1,t._imageSrc=function(e){var n,i;return n=r.exec(e),n?(i=n[1]||"","http"+i+"://"+n[2]+".staticflickr.com/"+n[3]+t._flickr_suffix+".jpg"):e},s=function(){var e=n("img.responsive");if(e.length){var r,i;r=n('<div id="flickr-image-holder"/>').css({height:"1px",width:"1px"}).fadeTo(1,.1).appendTo("body"),i=function(){r.find("img").length===0&&r.remove()},e.each(function(){var e=n(this),s=e.attr("src"),o=t._imageSrc(s),u;if(s===o)return s;u=n('<img src="'+o+'" alt="" height="1" width="1">'),r.append(u),u.on("load",function(){e.attr("src",o),u.remove(),i()})}),i()}},t.init=function(r,o,u,a){var f;a="fast",t._flickr_suffix_set||(r=r||n(window).width(),o=o||n(window).height(),u=u||i(window.devicePixelRatio)||1,f=Math.max(r,o),f*=u,f=i(f),a!=="fast"&&(a="slow"),f<280||a==="slow"?t._flickr_suffix="_m":f<320?t._flickr_suffix="_n":f<500?t._flickr_suffix="":f<640?t._flickr_suffix="_z":f<800?t._flickr_suffix="_c":t._flickr_suffix="_b",typeof e.PROFILE.profile=="object"&&(e.PROFILE.profile.flickr_suffix=t._flickr_suffix),typeof e.COOKIES!="undefined"&&e.COOKIES.setItem("flickr_suffix",t._flickr_suffix,null,"/"),t._flickr_suffix_set=!0),s()},e.register(t.init),t}(e,e.FLICKR||{},t),e}(window.DECADE_CITY||{},window.jQuery);